window.addEventListener("load",(function(){const t=document.getElementById("canvas1"),e=t.getContext("2d");t.width=1e3,t.height=500;class i{constructor(t){this.game=t,window.addEventListener("keydown",(t=>{"ArrowUp"!==t.key&&"ArrowDown"!==t.key||-1!==this.game.keys.indexOf(t.key)?" "===t.key?this.game.player.shootTop():"d"===t.key&&(this.game.debug=!this.game.debug):this.game.keys.push(t.key)})),window.addEventListener("keyup",(t=>{const e=this.game.keys.indexOf(t.key);e>-1&&this.game.keys.splice(e,1)}))}}class s{constructor(t,e,i){this.game=t,this.x=e,this.y=i,this.width=10,this.height=3,this.speed=3,this.markedForDeletion=!1,this.image=document.getElementById("projectile")}update(){this.x+=this.speed,this.x>.8*this.game.width&&(this.markedForDeletion=!0)}draw(t){t.drawImage(this.image,this.x,this.y)}}class h{constructor(t,e,i){this.game=t,this.x=e,this.y=i,this.image=document.getElementById("gears"),this.frameX=Math.floor(3*Math.random()),this.frameY=Math.floor(3*Math.random()),this.spriteSize=50,this.sizeModifier=(.5*Math.random()+.5).toFixed(1),this.size=this.spriteSize*this.sizeModifier,this.speedX=6*Math.random()-3,this.speedY=-15*Math.random(),this.gravity=.5,this.markedForDeletion=!1,this.angle=0,this.va=.2*Math.random()-.1,this.bounced=0,this.bottomBounceBoundary=80*Math.random()+60}update(){this.angle+=this.va,this.speedY+=this.gravity,this.x-=this.speedX+this.game.speed,this.y+=this.speedY,(this.y>this.game.height+this.size||this.x<0-this.size)&&(this.markedForDeletion=!0),this.y>this.game.height-this.bottomBounceBoundary&&this.bounced<2&&(this.bounced++,this.speedY*=-.5)}draw(t){t.save(),t.translate(this.x,this.y),t.rotate(this.angle),t.drawImage(this.image,this.frameX*this.spriteSize,this.frameY*this.spriteSize,this.spriteSize,this.spriteSize,-.5*this.size,-.5*this.size,this.size,this.size),t.restore()}}class a{constructor(t){this.game=t,this.width=120,this.height=190,this.x=20,this.y=100,this.frameX=0,this.frameY=0,this.speedY=0,this.maxFrame=37,this.maxSpeed=3,this.projectiles=[],this.image=document.getElementById("player"),this.powerUp=!1,this.powerUpTimer=0,this.powerUpLimit=1e4}update(t){this.game.keys.includes("ArrowUp")?this.speedY=-this.maxSpeed:this.game.keys.includes("ArrowDown")?this.speedY=+this.maxSpeed:this.speedY=0,this.y+=this.speedY,this.y>this.game.height-.5*this.height?this.y=this.game.height-.5*this.height:this.y<.5*-this.height&&(this.y=.5*-this.height),this.projectiles.forEach((t=>{t.update()})),this.projectiles=this.projectiles.filter((t=>!t.markedForDeletion)),this.frameX<this.maxFrame?this.frameX++:this.frameX=0,this.powerUp&&(this.powerUpTimer>this.powerUpLimit?(this.powerUpTimer=0,this.powerUp=!1,this.frameY=0):(this.powerUpTimer+=t,this.frameY=1,this.game.ammo+=.1))}draw(t){this.game.debug&&t.strokeRect(this.x,this.y,this.width,this.height),this.projectiles.forEach((e=>{e.draw(t)})),t.drawImage(this.image,this.frameX*this.width,this.frameY*this.height,this.width,this.height,this.x,this.y,this.width,this.height)}shootTop(){this.game.ammo>0&&(this.projectiles.push(new s(this.game,this.x+80,this.y+30)),this.game.ammo--),this.powerUp&&this.shootBottom()}shootBottom(){this.game.ammo>0&&(this.projectiles.push(new s(this.game,this.x+80,this.y+175)),this.game.ammo--)}enterPowerUp(){this.powerUpTimer=0,this.powerUp=!0,this.game.ammo<this.game.maxAmmo&&(this.game.ammo=this.game.maxAmmo)}}class r{constructor(t){this.game=t,this.x=this.game.width,this.speedX=-1.5*Math.random()-.5,this.markedForDeletion=!1,this.frameX=0,this.frameY=0,this.maxFrame=37}update(){this.x+=this.speedX-this.game.speed,this.x+this.width<0&&(this.markedForDeletion=!0),this.frameX<this.maxFrame?this.frameX++:this.frameX=0}draw(t){this.game.debug&&t.strokeRect(this.x,this.y,this.width,this.height),t.drawImage(this.image,this.frameX*this.width,this.frameY*this.height,this.width,this.height,this.x,this.y,this.width,this.height),this.game.debug&&(t.font="20px Helvetica",t.fillText(this.lives,this.x,this.y))}}class m extends r{constructor(t){super(t),this.width=228,this.height=169,this.y=Math.random()*(.95*this.game.height-this.height),this.image=document.getElementById("angler1"),this.frameY=Math.floor(3*Math.random()),this.lives=5,this.score=this.lives}}class o extends r{constructor(t){super(t),this.width=213,this.height=165,this.y=Math.random()*(.95*this.game.height-this.height),this.image=document.getElementById("angler2"),this.frameY=Math.floor(2*Math.random()),this.lives=6,this.score=this.lives}}class d extends r{constructor(t){super(t),this.width=99,this.height=95,this.y=Math.random()*(.95*this.game.height-this.height),this.image=document.getElementById("lucky"),this.frameY=Math.floor(2*Math.random()),this.lives=5,this.score=15,this.type="lucky"}}class n extends r{constructor(t){super(t),this.width=400,this.height=227,this.y=Math.random()*(.95*this.game.height-this.height),this.image=document.getElementById("hivewhale"),this.frameY=0,this.lives=20,this.score=this.lives,this.type="hive",this.speedX=-1.2*Math.random()-.2}}class g extends r{constructor(t,e,i){super(t),this.width=115,this.height=95,this.x=e,this.y=i,this.image=document.getElementById("drone"),this.frameY=Math.floor(2*Math.random()),this.lives=3,this.score=this.lives,this.type="drone",this.speedX=-4.2*Math.random()-.5}}class l{constructor(t,e,i){this.game=t,this.image=e,this.speedModifier=i,this.width=1768,this.height=500,this.x=0,this.y=0}update(){this.x<=-this.width&&(this.x=0),this.x-=this.game.speed*this.speedModifier}draw(t){t.drawImage(this.image,this.x,this.y),t.drawImage(this.image,this.x+this.width,this.y)}}class p{constructor(t){this.game=t,this.image1=document.getElementById("layer1"),this.image2=document.getElementById("layer2"),this.image3=document.getElementById("layer3"),this.image4=document.getElementById("layer4"),this.layer1=new l(this.game,this.image1,.2),this.layer2=new l(this.game,this.image2,.4),this.layer3=new l(this.game,this.image3,1),this.layer4=new l(this.game,this.image4,1.3),this.layers=[this.layer1,this.layer2,this.layer3]}update(){this.layers.forEach((t=>t.update()))}draw(t){this.layers.forEach((e=>e.draw(t)))}}class c{constructor(t,e,i){this.game=t,this.frameX=0,this.spriteWidth=200,this.spriteHeight=200,this.width=this.spriteWidth,this.height=this.spriteHeight,this.x=e-.5*this.width,this.y=i-.5*this.height,this.fps=30,this.timer=0,this.interval=1e3/this.fps,this.markedForDeletion=!1,this.maxFrame=8}update(t){this.x-=this.game.speed,this.timer>this.interval?(this.frameX++,this.timer=0):this.timer+=t,this.frameX>this.maxFrame&&(this.markedForDeletion=this.true)}draw(t){t.drawImage(this.image,this.frameX*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.x,this.y,this.width,this.height)}}class y extends c{constructor(t,e,i){super(t,e,i),this.image=document.getElementById("smokeExplosion")}}class w extends c{constructor(t,e,i){super(t,e,i),this.image=document.getElementById("fireExplosion")}}class u{constructor(t){this.game=t,this.fontSize=25,this.fontFamily="Bangers",this.color="white"}draw(t){t.save(),t.fillStyle=this.color,t.shadowOffsetX=2,t.shadowOffsetY=2,t.shadowColor="black",t.font=this.fontSize+"px "+this.fontFamily,t.fillText("Score: "+this.game.score,20,40);const e=(.001*this.game.gameTime).toFixed(1);if(t.fillText("Timer: "+e,20,100),this.game.gameOver){let e,i;t.textAlign="center",this.game.score>this.game.winningScore?(e="Most Wondrous!",i="Well done explorer!"):(e="Defeated!",i="Try again next time!"),t.font="70px "+this.fontFamily,t.fillText(e,.5*this.game.width,.5*this.game.height-20),t.font="25px "+this.fontFamily,t.fillText(i,.5*this.game.width,.5*this.game.height+20);const s=document.getElementById("replay");s.style.display="block",s.addEventListener("click",(function(){f.gameOver=!1,f.gameTime=6e4,f.score=0,f.enemies=[],f.player.powerUp=!1,f.player.frameY=0,f.ammo=20,s.style.display="none",s.removeEventListener("click",this)}))}this.game.player.powerUp&&(t.fillStyle="#ffffbd");for(let e=0;e<this.game.ammo;e++)t.fillRect(20+5*e,50,3,20);t.restore()}}const f=new class{constructor(t,e){this.width=t,this.height=e,this.background=new p(this),this.player=new a(this),this.input=new i(this),this.ui=new u(this),this.keys=[],this.enemies=[],this.particles=[],this.explosions=[],this.enemyTimer=0,this.enemyInterval=1700,this.ammo=20,this.maxAmmo=50,this.ammoTimer=0,this.ammoInterval=350,this.gameOver=!1,this.score=0,this.winningScore=200,this.gameTime=6e4,this.timeLimit=0,this.speed=1,this.debug=!1}update(t){this.gameOver||(this.gameTime-=t),this.gameTime<this.timeLimit&&(this.gameOver=!0),this.background.update(),this.background.layer4.update(),this.player.update(t),this.ammoTimer>this.ammoInterval?(this.ammo<this.maxAmmo&&this.ammo++,this.ammoTimer=0):this.ammoTimer+=t,this.particles.forEach((t=>t.update())),this.particles=this.particles.filter((t=>!t.markedForDeletion)),this.explosions.forEach((e=>e.update(t))),this.explosions=this.explosions.filter((t=>!t.markedForDeletion)),this.enemies.forEach((t=>{if(t.update(),this.checkCollision(this.player,t)){t.markedForDeletion=!0,this.addExplosion(t);for(let e=0;e<t.score;e++)this.particles.push(new h(this,t.x+.5*t.width,t.y+.5*t.height));"lucky"===t.type?this.player.enterPowerUp():this.gameOver||this.score--}this.player.projectiles.forEach((e=>{if(this.checkCollision(e,t)&&(t.lives--,e.markedForDeletion=!0,this.particles.push(new h(this,t.x+.5*t.width,t.y+.5*t.height)),t.lives<=0)){for(let e=0;e<t.score;e++)this.particles.push(new h(this,t.x+.5*t.width,t.y+.5*t.height));if(t.markedForDeletion=!0,this.addExplosion(t),"hive"===t.type)for(let e=0;e<4;e++)this.enemies.push(new g(this,t.x+Math.random()*t.width,t.y+Math.random()*t.height*.5));this.gameOver||(this.score+=t.score)}}))})),this.enemies=this.enemies.filter((t=>!t.markedForDeletion)),this.enemyTimer>this.enemyInterval&&!this.gameOver?(this.addEnemy(),this.enemyTimer=0):this.enemyTimer+=t}draw(t){this.background.draw(t),this.player.draw(t),this.particles.forEach((e=>e.draw(t))),this.enemies.forEach((e=>{e.draw(t)})),this.explosions.forEach((e=>{e.draw(t)})),this.ui.draw(t),this.background.layer4.draw(t)}addEnemy(){const t=Math.random();t<.3?this.enemies.push(new m(this)):t<.6?this.enemies.push(new o(this)):t<.7?this.enemies.push(new n(this)):this.enemies.push(new d(this))}addExplosion(t){Math.random()<.5?this.explosions.push(new y(this,t.x+.5*t.width,t.y+.5*t.height)):this.explosions.push(new w(this,t.x+.5*t.width,t.y+.5*t.height))}checkCollision(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.height+t.y>e.y}}(t.width,t.height);let x=0;!function i(s){const h=s-x;x=s,e.clearRect(0,0,t.width,t.height),f.draw(e),f.update(h),requestAnimationFrame(i)}(0)}));